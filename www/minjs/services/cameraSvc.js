!function(){"use strict";define(["./module","cordova"],function(e){function t(e,t,o,a,r,n){function i(t){var o,r=e.defer();return o=0===t?{destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.CAMERA}:{destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.PHOTOLIBRARY},a.getPicture(o).then(function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise}function c(t,a){var i=e.defer(),c="",u={fileKey:"file",fileName:a.substr(a.lastIndexOf("/")+1),chunkedMode:!1,mimeType:"image/jpg",params:{directory:"upload",fileName:a.substr(a.lastIndexOf("/")+1),gallery:"avatar"},headers:{"x-app-version":"0.0.1","x-access-token":c}};return null!=window.localStorage.getItem("token")&&""!==window.localStorage.getItem("token")&&(c=window.localStorage.getItem("token")),o.upload(t,a,u).then(function(e){var t=JSON.parse(e.response);t.status&&i.resolve(t.data)},function(e){i.reject(e)},function(e){var t=e.loaded/e.total*100;r.show({template:"已经上传："+Math.floor(t)+"%"}),t>98?r.hide():n(function(){r.hide()},15e3)}),i.promise}var u={getPicture:i,uploadPicture:c};return u}t.$inject=["$q","$ionicPopup","$cordovaFileTransfer","$cordovaCamera","$ionicLoading","$timeout"],e.factory("cameraService",t)})}();