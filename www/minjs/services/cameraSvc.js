!function(){"use strict";define(["./module","cordova"],function(e){function t(e,t,o,r,a,n){function i(t){var o=e.defer(),a=Camera.PictureSourceType.PHOTOLIBRARY,n={destinationType:Camera.DestinationType.FILE_URI,sourceType:a};return 0===t&&(a=Camera.PictureSourceType.CAMERA),r.getPicture(n).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise}function c(t,r){var i=e.defer(),c="",u={fileKey:"file",fileName:r.substr(r.lastIndexOf("/")+1),chunkedMode:!1,mimeType:"image/jpg",params:{directory:"upload",fileName:r.substr(r.lastIndexOf("/")+1),gallery:"avatar"},headers:{"x-app-version":"0.0.1","x-access-token":c}};return null!=window.localStorage.getItem("token")&&""!==window.localStorage.getItem("token")&&(c=window.localStorage.getItem("token")),o.upload(t,r,u).then(function(e){var t=JSON.parse(e.response);t.status&&i.resolve(t.data)},function(e){i.reject(e)},function(e){var t=e.loaded/e.total*100;a.show({template:"已经上传："+Math.floor(t)+"%"}),t>98?a.hide():n(function(){a.hide()},15e3)}),i.promise}var u={getPicture:i,uploadPicture:c};return u}t.$inject=["$q","$ionicPopup","$cordovaFileTransfer","$cordovaCamera","$ionicLoading","$timeout"],e.factory("cameraService",t)})}();