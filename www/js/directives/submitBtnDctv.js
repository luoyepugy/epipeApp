define(["./module"],function(e){e.directive("submitButton",["httpService","messageService","validateService","$state","userService",function(e,t,n,i,o){return{restrict:"E",template:'<button class="button button-full button-energized button-round">{{text}}</button>',replace:!0,scope:{},link:function(r,s,u){r.text=u.text;var a,l,c=u.state||"",f=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,d=/^((145|147)|(15[^4])|(17[6-8])|((13|18)[0-9]))\d{8}$/;s.bind("click",function(){if(a=n.isEmpty(u.form),1!==a)return t.show(a),!1;if(l=n.submitData(u.form),null!==l.email&&void 0!==l.email&&f.test(l.email)===!1)t.show("请输入正确的邮箱格式");else if(null!==l.phone&&void 0!==l.phone&&d.test(l.phone)===!1)t.show("请输入正确的手机号码格式");else if(null!==l.confirmPwd&&void 0!==l.confirmPwd&&l.confirmPwd!==l.password)t.show("两次密码输入不一致");else{var s=e.getData(u.action,l);s.then(function(e){if(t.show(e.message),i.go(c),"true"===u.user)for(var n in r.$parent.user)o.user[n]=r.$parent.user[n];else"true"===u.login&&(o.user=e.user)})}})}}}])});